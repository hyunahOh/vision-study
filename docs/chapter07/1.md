---
layout: post
title: "7.1 필터링"
author: 김주은
---

## 1. 필터링 연산 방법

영상 처리에서 필터링은 영상에서 원하는 정보만 통과시키고 원치 않는 정보는 걸러내는 작업이다. 영상의 필터링은 보통 `mask`라고 부르는 작은 크기의 행렬을 이용한다. 마스크는 필터링의 성격을 정의하는 행렬이며 커널(kernel), 윈도우(wondow)라고 부른다.

<center><img src="https://thebook.io/img/006939/p245_1.jpg" width="70%" alt="필터링"></center>

여러 가지 필터 마스크를 나타낸 그림이다. 필터 마스크 중에서 3x3 정방형 행렬이 다양한 필터링 연산에서 널리 사용되고 있다. 위 그림에서 진한 색으로 표시한 위치는 `고정점(anchor point)`을 나타낸다. 고정점은 현재 필터링 작업을 수행하고 있는 기준 픽셀 위치를 나타내고, 대부분의 경우 마스크 행렬 정중앙을 고정점으로 사용한다.

<center><img src="https://thebook.io/img/006939/p246_1.jpg" width="70%" alt=" mask를 이용한 필터링 연산 방법"></center>

(x,y) 좌표에서 마스크 연산을 통해 결과 영상의 픽셀값 g(x,y)를 구했으면, 다음에는 마스크를 한 픽셀 옆으로 이동하여 (x+1, y)좌표에 다시 마스크 연산ㅇ르 수행하고 그 결과를 g(x+1, y)에 저장한다. 이 과정을 영상 전체 픽셀에 대해 수행하면 필터링이 완료된다.

## 2. filter2D( ) 함수
```c
void filter2D(InputArray src, OutputArray dst, int ddepth, InputArray kernel, Point anchor = Point(-1, 1), double delta = 0, int borderType = BORDER_DEFAULT);
```
- src : 입력 영상
- dst : 출력 영상. src와 같은 크기. 같은 채널 수를 갖는다.
- ddepth : 결과 영상의 깊이
- kernel : 필터링 커널. 1채널 실수형 행렬
- anchor : 고정점 좌표. Point(-1, -1)을 지정하면 커널 중심으로 고정점을 사용한다.
- delta : 필터링 연산 후 추가적으로 더할 값
- borderType : 가장자리 픽셀 확장 방식

![가장자리 픽셀 처리 방법]({{ site.baseurl }}/images/ch7-1.JPG){: width="100%"} 


## 3. 엠보싱 필터링
엠보싱은 직물이나 종이, 금속판 등에 올록볼록한 형태로 만든 객체의 윤곽 또는 무늬를 뜻하며, 엠보싱 필터는 입력 영상을 엠보싱 느낌이 나도록 변환하는 필터이다.

<center><img src="https://thebook.io/img/006939/p250.jpg" width="50%" alt=" 엠보싱 필터 마스크"></center>

`엠보싱 필터 마스크`는 대각선 방향으로 +1 또는 -1의 값이 지정되어 있는 3x3 행렬이다.
이 필터 마스크를 사용하여 필터링을 수행하면 대각선 방향으로 픽셀 값이 급격하게 변하는 부분에서 결과 영상 픽셀 값이 0보다 훨씬 크거나, 또는 0보다 훨씬 작은 값을 가지게 된다. 입력 영상에서 픽셀 값이 크게 바뀌지 않는 평탄한 영역에서는 결과 영상의 픽셀 값이 0에 가까운 값을 가지게 된다.
